<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <%- include("../utils/header.ejs") %>
    <title>Document</title>
</head>
<style>
    body{
        overflow: hidden;
    }
    #table-info{
        width: 100vw;
        height: 85vh;
        overflow: auto;
    }
    th:not:first-child, td{
        min-width: 25em;
        font-size: smaller;
    }
    .checkbox{
        min-width: 1em;
    }
    input[type="checkbox"]{
        cursor: pointer;
        width: 1.95em;
        height: 1.95em;
    }
    .label{
        font-weight: bolder;
        font-size: x-small;
    }
    #table-info th, #table-info td{
        padding: 0 !important;
    }
    #table-info td{
        border-top: none;
    }
    #table-info{
        border-spacing: 0px !important;
    }
    #table-create tbody td{
       padding: 0.6em;
    }
    #table-update tbody td{
        padding: 0.6em;
    }
    .error-message{
        color: red;
    }
    select{
        width: 12em;
        height: 2em;
    }
    
</style>
<body>
    <%- include("../layout/navbar.ejs") %>
    <div id="table-info">
        <table class="table table-hover" id="table-infor">
            <thead class="thead-dark table-hover">
                <th id="thead-check-box"></th>
                <th id="thead-week" style="min-width: 3em;">WEEK</th>
                <th id="thead-stt" style="min-width: 3em;">STT</th>
                <th id="thead-no-booking" style="min-width: 5em;">BK NO</th>
                <!-- <th id="thead-estimated-loading-date" style="min-width: 3em;" style="display:none">E.L DATE</th> -->
                <th id="thead-request-loading" style="min-width: 10em;">REQUEST LOADING</th>
                <th id="thead-container-number" style="min-width: 10em;">CONT NUMBER</th>
                <th id="thead-seal-number" style="min-width: 10em;">SEAL NUMBER</th>
                <th id="thead-dc" style="min-width: 6em;">DC</th>
                <th id="thead-carrier" style="min-width: 10em;">CARRIER</th>
                <th id="thead-loading-location" style="min-width: 5em;">LOAD LOCATE</th>
                <th id="thead-loading-date" style="min-width: 10em;">LOADING DATE</th>
                <th id="thead-ship-date" style="min-width: 10em;">SHIP DATE</th>
                <th id="thead-cdf-date" style="min-width: 10em;">CDF DATE</th>
                <th id="thead-booking-number" style="min-width: 8em;">BK NUMBER</th>
                <th id="thead-cut-off-loading-date" style="min-width: 10em;">CUT OFF LOAD DATE</th>
                <th id="thead-cy-cut-off" style="min-width: 10em;">CY CUT OFF</th>
                <th id="thead-ammentdent-bill-cut-off" style="min-width: 10em;">AMMENTDENT BILL CUT OFF</th>
                <th id="thead-etd" style="min-width: 10em;">ETD</th>
                <th id="thead-new-etd" style="min-width: 10em;">NEW ETD</th>
                <th id="thead-service" style="min-width: 12em;">SERVICE</th>
                <th id="thead-eta" style="min-width: 10em;">ETA</th>
                <th id="thead-vessel" style="min-width: 12em;">VESSEL</th>
                <th id="thead-picked-date" style="min-width: 10em;">PICKED DATE</th>
                <th id="thead-vendor" style="min-width: 8em;">VENDOR</th>
                <th id="thead-ata-pb" style="min-width: 10em;">ATA PHU BAI</th>
                <th id="thead-unloading-location" style="min-width: 12em;">UNLOADING LOCATION</th>
                <th id="thead-unloading-date" style="min-width: 10em;">UNLOADING DATE</th>
                <th id="thead-export-saving-thuck-date" style="min-width: 12em;">EXPORT SAVING TRUCK DATE</th>
                <th id="thead-reason-export-saving-truck" style="min-width: 10em;">REASON EXPORT SAVING TRUCK</th>
                <th id="thead-picked-at-port" style="min-width: 10em;">PICK PORT</th>
                <th id="thead-dropping-at-port" style="min-width: 12em;">DROPPING AT PORT</th>
                <th id="thead-dropping-date" style="min-width: 10em;">DROPPING DATE</th>
                <!-- <th id="thead-new-eta">NEW ETA</th> -->
                <th id="thead-cont-category" style="min-width: 3em;" style="min-width: 5em;">CONT TYPE</th>
                <th id="thead-pre-booking-number" style="min-width: 12em;">PRE-BOOKING NUMBER</th>
                <th id="thead-note" style="min-width: 12em;">NOTE</th>
            </thead>
            <tbody>
                <tr id="tbody-1" ondblclick="updateDataRow(this)">
                    <td class="td-check-box"><input class="input-checkbox" type="checkbox"></div></td>
                    
                    <td class="td-week">
                        <input style="width: 3em;" readonly class="input-week" type="number" placeholder="WEEK" oninput="changeWeek()">
                        <div class="error-message error-input-week"></div>
                    </td>

                    <td class="td-stt" style="text-align:center">1</td>

                    <td class="td-no-booking">
                        <input style="width: 5em;" class="input-no-booking" placeholder="NO BOOKING" type="number">
                        <div class="error-message error-input-no-booking"></div>
                    </td>

                    <td class="td-estimated-loading-date" style="display: none;">
                        <input class="input-estimated-loading-date" placeholder="ESTIMATE LOADING DATE" type="text">
                        <div class="error-message error-input-estimated-loading-date"></div>
                    </td>

                    <td class="td-request-loading">
                        <input class="input-request-loading datetime" placeholder="REQUEST LOADING" onmouseenter="addDateTime(this)" type="text">
                        <div class="error-message error-input-estimated-loading-date"></div>
                    </td>

                    <td class="td-container-number">
                        <input class="input-container-number" placeholder="CONTAINER NUMBER" type="text">
                        <div class="error-message error-input-container-number"></div>
                    </td>

                    <td class="td-seal-number">
                        <input class="input-seal-number" placeholder="SEAL NUMBER" type="text">
                        <div class="error-message error-input-seal-number"></div>
                    </td>

                    <td class="td-dc">
                        <input class="input-dc" placeholder="DC" type="text">
                        <div class="error-message error-input-dc"></div>
                    </td>

                    <td class="td-carrier">
                        <input class="input-carrier" placeholder="CARRIER" type="text" oninput="copyDataAllowBooking(this)">
                        <div class="dropdown">
                            <button onclick="myFunction('dropdown-1')" class="dropbtn" id="dropbtn-1">Dropdown</button>
                            <div id="dropdown-1" class="dropdown-content select-carrier">
                              <input class="input-search-droplist" type="text" placeholder="Search.." id="input-search-dropdown-1" onkeyup="filterFunction('input-search-dropdown-1', 'dropdown-1')">
                              
                            </div>
                        </div>
                        <div class="error-message error-input-carrier"></div>
                    </td>

                    <td class="td-loading-location">
                        <input class="input-loading-location" placeholder="LOADING LOCATION" type="text">
                        <select class="select-loading-location" style="width: 5em;"></select>
                        <div class="error-message error-input-loading-location"></div>
                    </td>

                    <td class="td-loading-date">
                        <input class="input-loading-date datetime" onmouseenter="addDateTime(this)" placeholder="LOADING DATE" type="text">
                        <div class="error-message error-input-loading-date datetime"></div>
                    </td>

                    <td class="td-ship-date">
                        <input class="input-ship-date datetime" onmouseenter="addDateTime(this)" placeholder="SHIP DATE" type="text">
                        <div class="error-message error-input-ship-date datetime"></div>
                    </td>

                    <td class="td-cdf-date">
                        <input class="input-cdf-date datetime" onmouseenter="addDateTime(this)" placeholder="CDF DATE" type="text">
                        <div class="error-message error-input-cdf-date datetime"></div>
                    </td>

                    <td class="td-booking-number">
                        <input class="input-booking-number" placeholder="BOOKING NUMBER" type="text" oninput="autoFillAllowBook(this, 'table-info')">
                        <div class="error-message error-input-booking-number"></div>
                    </td>

                    <td class="td-cut-off-loading-date">
                        <input class="input-cut-off-loading-date datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CUT OFF LOADING DATE" type="text">
                        <div class="error-message error-input-cut-off-loading-date datetime"></div>
                    </td>

                    <td class="td-cy-cut-off">
                        <input class="input-cy-cut-off datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CY CUT OFF" type="text">
                        <div class="error-message error-input-cy-cut-off datetime"></div>
                    </td>

                    <td class="td-ammentdent-bill-cut-off">
                        <input class="input-ammentdent-bill-cut-off datetime" onchange="copyDataAllowBooking(this)" onmouseenter="addDateTime(this)" placeholder="AMMENTDENT BILL CUT OFF" type="text">
                        <div class="error-message error-input-ammentdent-bill-cut-off datetime"></div>
                    </td>

                    <td class="td-etd">
                        <input class="input-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="ETD" type="text">
                        <div class="error-message error-input-etd datetime"></div>
                    </td>

                    <td class="td-new-etd">
                        <input class="input-new-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="NEW ETD" type="text">
                        <div class="error-message error-input-new-etd datetime"></div>
                    </td>

                    <td class="td-service">
                        <input class="input-service" placeholder="SERVICE" oninput="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-service"></div>
                    </td>

                    <td class="td-eta">
                        <input class="input-eta" placeholder="ETA" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-eta"></div>
                    </td>

                    <td class="td-vessel">
                        <input class="input-vessel" placeholder="VESSEL" oninput="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-vessel"></div>
                    </td>

                    <td class="td-picked-date">
                        <input class="input-picked-date datetime" onmouseenter="addDateTime(this)" placeholder="PICKED DATE" type="text">
                        <div class="error-message error-input-picked-date datetime"></div>
                    </td>

                    <td class="td-vendor">
                        <input class="input-vendor" placeholder="VENDOR" type="text">
                        <select class="select-vendor"></select>
                        <div class="error-message error-input-vendor"></div>
                    </td>

                    <td class="td-ata-pb">
                        <input class="input-ata-pb datetime" onmouseenter="addDateTime(this)" placeholder="ATA PHU BAI" type="text">
                        <div class="error-message error-input-ata-pb datetime"></div>
                    </td>

                    <td class="td-unloading-location">
                        <input class="input-unloading-location" placeholder="UNLOADING LOCATION" type="text">
                        <div class="error-message error-input-unloading-location"></div>
                    </td>
                    
                    <td class="td-unloading-date">
                        <input class="input-unloading-date datetime" onmouseenter="addDateTime(this)" placeholder="UNLOADING DATE" type="text">
                        <div class="error-message error-input-unloading-date datetime"></div>
                    </td>

                    <td class="td-export-saving-truck-date">
                        <input class="input-export-saving-truck-date" placeholder="EXPORT SAVING TRUCK DATE" type="text">
                        <div class="error-message error-input-export-saving-truck-date"></div>
                    </td>

                    <td class="td-reason-export-saving-truck">
                        <textarea class="input-reason-export-saving-truck" placeholder="REASON EXPORT SAVING TRUCK"></textarea>
                        <div class="error-message error-input-reason-export-saving-truck"></div>
                    </td>

                    <td class="td-picked-at-port">
                        <input class="input-picked-at-port" style="width:10em"/>
                        <select class="select-picked-at-port" id="select-id" style="width:10em"></select>
                        <div class="error-message error-input-picked-at-port"></div>
                    </td>

                    <td class="td-dropping-at-port">
                        <input class="input-dropping-at-port" placeholder="DROPPING AT PORT" type="text">
                        <select class="select-dropping-at-port"></select>
                        <div class="error-message error-input-dropping-at-port"></div>
                    </td>

                    <td class="td-dropping-date">
                        <input class="input-dropping-date datetime" onmouseenter="addDateTime(this)" placeholder="DROPPING DATE" type="text">
                        <div class="error-message error-input-dropping-date datetime"></div>
                    </td>

                    <td class="td-category-cont">
                        <input style="width: 3em;" class="input-category-cont" type="text" placeholder="CONT CATEGORY" oninput="copyDataAllowBooking(this)" value="40">
                        <div class="error-message error-input-category-cont"></div>
                    </td>
                
                    <td class="td-pre-booking-number">
                        <input class="input-pre-booking-number" placeholder="PRE BOOKING NUMBER" type="text" oninput="copyDataAllowBooking(this)">
                        <div class="error-message error-input-pre-booking-number"></div>
                    </td>            

                    <td class="td-note">
                        <textarea class="input-note" placeholder="NOTE" type="text"></textarea>
                        <div class="error-message error-input-note"></div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div style="display: flex; gap: 1em; margin-left: 50vw;">
        <button class="btn btn-primary create-delete" id="create-btn" data-toggle="modal" data-target="#createRow"><i class="fa-solid fa-plus"></i></button>
        <button class="btn btn-danger create-delete" id="delete-btn" onclick="deleteRow()"><i class="fa-solid fa-trash"></i></button>
        <button class="btn btn-success" id="upload-btn" onclick="postData()">
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" id="loading-post-data" style="display: none;"></span>
            <i class="fa-solid fa-upload" id="create-post-data" ></i>
        </button>
    </div>

    <!-- modal create new row -->
    <div class="modal fade" id="createRow"  role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">CREATE NEW ROW</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="display: flex; justify-content: space-between;">
                <table id="table-create">
                    <tbody>
                        <tr>
                            <td class="td-week">
                                <div class="label">WEEK:</div>
                                <input class="input-week" type="number" placeholder="WEEK" oninput="changeWeek()">
                            </td>

                            <td class="td-no-booking">
                                <div class="label">NO BOOKING:</div>
                                <input class="input-no-booking" placeholder="NO BOOKING" type="number">
                            </td>

                            <td class="td-estimated-loading-date" style="display: none;">
                                <div class="label">ESTIMATED LOADING DATE:</div>
                                <input class="input-estimated-loading-date" placeholder="ESTIMATED LOADING DATE" type="text">
                            </td>

                            <td class="td-request-loading">
                                <div class="label">REQUEST LOADING:</div>
                                <input onmouseenter="addDateTime(this)" class="input-request-loading datetime" placeholder="REQUEST LOADING" type="text">
                            </td>
                        <tr>
                            <td class="td-container-number">
                                <div class="label">CONTAINER NUMBER:</div>
                                <input class="input-container-number" placeholder="CONTAINER NUMBER" type="text">
                            </td>  

                            <td class="td-seal-number">
                                <div class="label">SEAL NUMBER:</div>
                                <input class="input-seal-number" placeholder="SEAL NUMBER" type="text">
                            </td>

                            <td class="td-dc">
                                <div class="label">DC:</div>
                                <input class="input-dc" placeholder="DC" type="text">
                            </td> 

                            <td class="td-carrier">
                                <div class="label">CARRIER:</div>
                                <input class="input-carrier" placeholder="CARRIER" type="text" oninput="copyDataAllowBooking(this)" onchange="copyDataAllowBooking(this)">
                                <div class="dropdown">
                                    <button onclick="myFunction('table-create-dropdown-1')" class="dropbtn" id="dropbtn-1">Dropdown</button>
                                    <div id="table-create-dropdown-1" class="dropdown-content select-carrier">
                                      <input class="input-search-droplist" type="text" placeholder="Search.." id="table-create-input-search-dropdown-1" onkeyup="filterFunction('table-create-input-search-dropdown-1', 'table-create-dropdown-1')">
                                      
                                    </div>
                                </div>
                            </td>  
                        </tr>
                        <tr>
                            <td class="td-loading-location">
                                <div class="label">LOADING LOCATION:</div>
                                <input class="input-loading-location" placeholder=" LOADING LOCATION" type="text">
                                <select class="select-loading-location"></select>
                            </td>   

                            <td class="td-loading-date">
                                <div class="label">LOADING DATE:</div>
                                <input class="input-loading-date datetime" onmouseenter="addDateTime(this)" placeholder="LOADING DATE" type="text">
                            </td>
                            
                            <td class="td-ship-date">
                                <div class="label">SHIP DATE:</div>
                                <input class="input-ship-date datetime" onmouseenter="addDateTime(this)" placeholder="SHIP DATE" type="text">
                            </td>   

                            <td class="td-cdf-date">
                                <div class="label">CDF DATE:</div>
                                <input class="input-cdf-date datetime" onmouseenter="addDateTime(this)" placeholder="CDF DATE" type="text">
                            </td>
                        </tr>

                        <tr>
                            <td class="td-booking-number">
                                <div class="label">BOOKING NUMBER:</div>
                                <input value="" class="input-booking-number" placeholder="BOOKING NUMBER" type="text" oninput="autoFillAllowBook(this, 'table-create')">
                            </td>

                            <td class="td-cut-off-loading-date">
                                <div class="label">CUT OFF LOADING DATE:</div>
                                <input class="input-cut-off-loading-date datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CUT OFF LOADING DATE" type="text">
                            </td>

                            <td class="td-cy-cut-off">
                                <div class="label">CY CUT OFF:</div>
                                <input class="input-cy-cut-off datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CY CUT OFF" type="text">
                            </td>

                            <td class="td-ammentdent-bill-cut-off">
                                <div class="label">AMMENTDENT BILL CUT OFF:</div>
                                <input class="input-ammentdent-bill-cut-off datetime" onchange="copyDataAllowBooking(this)" onmouseenter="addDateTime(this)" placeholder="AMMENTDENT BILL CUT OFF" type="text">
                            </td>
                            
                        </tr>
                            <td class="td-etd">
                                <div class="label">ETD:</div>
                                <input class="input-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="ETD" type="text">
                            </td>

                            <td class="td-new-etd">
                                <div class="label">NEW ETD:</div>
                                <input class="input-new-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="NEW ETD" type="text">
                            </td>

                            <td class="td-service">
                                <div class="label">SERVICE:</div>
                                <input class="input-service" placeholder="SERVICE" oninput="copyDataAllowBooking(this)" type="text">
                            </td>

                            <td class="td-eta">
                                <div class="label">ETA:</div>
                                <input class="input-eta" placeholder="ETA" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" type="text">
                            </td> 
                        <tr>
                            <td class="td-vessel">
                                <div class="label">VESSEL:</div>
                                <input class="input-vessel" placeholder="VESSEL" oninput="copyDataAllowBooking(this)" type="text">
                            </td>

                            <td class="td-picked-date">
                                <div class="label">PICKED DATE:</div>
                                <input class="input-picked-date datetime" onmouseenter="addDateTime(this)" placeholder="PICKED DATE" type="text">
                            </td>

                            <td class="td-vendor">
                                <div class="label">VENDOR:</div>
                                <input class="input-vendor" placeholder="VENDOR" type="text">
                                <select class="select-vendor"></select>
                            </td>

                            <td class="td-ata-pb">
                                <div class="label">ATA PHU BAI:</div>
                                <input class="input-ata-pb datetime" onmouseenter="addDateTime(this)" placeholder="ATA PHU BAI" type="text">
                            </td>
                        </tr>
                        <tr>
                            <td class="td-unloading-location">
                                <div class="label">UNLOADING LOCATION:</div>
                                <input class="input-unloading-location" placeholder="UNLOADING LOCATION" type="text">
                            </td>

                            <td class="td-unloading-date">
                                <div class="label">UNLOADING DATE:</div>
                                <input class="input-unloading-date datetime" onmouseenter="addDateTime(this)" placeholder="UNLOADING DATE" type="text">
                            </td>

                            <td class="td-export-saving-truck-date">
                                <div class="label">EXPORT SAVING TRUCK DATE:</div>
                                <input class="input-export-saving-truck-date" placeholder="EXPORT SAVING TRUCK DATE" type="text">
                            </td>
                            
                            <td class="td-reason-export-saving-truck">
                                <div class="label">REASON EXPORT SAVING TRUCK:</div>
                                <textarea class="input-reason-export-saving-truck" placeholder="REASON EXPORT SAVING TRUCK">

                                </textarea>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-picked-at-port">
                                <div class="label">PICKED AT PORT:</div>
                                <input class="input-picked-at-port"/>
                                <select class="select-picked-at-port"></select>
                            </td>

                            <td class="td-dropping-at-port">
                                <div class="label">DROPPING AT PORT:</div>
                                <input class="input-dropping-at-port" placeholder="DROPPING AT PORT" type="text">
                                <select class="select-dropping-at-port"></select>
                            </td>

                            <td class="td-dropping-date">
                                <div class="label">DROPPING DATE:</div>
                                <input class="input-dropping-date datetime" onmouseenter="addDateTime(this)" placeholder="DROPPING DATE" type="text">
                            </td>

                            <td class="td-category-cont">
                                <div class="label">CONT TYPE</div>
                                <input class="input-category-cont" type="text" placeholder="CONT TYPE" oninput="copyDataAllowBooking(this)">
                            </td>
                        </tr>
                        <tr>
                            <td class="td-pre-booking-number">
                                <div class="label">PRE BOOKING NUMBER:</div>
                                <input class="input-pre-booking-number" placeholder="PRE BOOKING NUMBER" type="text">
                            </td>

                            <td class="td-note">
                                <div class="label">NOTE:</div>
                                <textarea class="input-note" placeholder="NOTE" type="text"></textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="createRow()">Save changes</button>
            </div>
          </div>
        </div>
    </div>

    <!-- modal update row -->
    <div class="modal fade" id="updateRow"  role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">UPDATE ROW</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="display: flex; justify-content: space-between;">
                <table id="table-update">
                    <tbody>
                        <tr>
                            <td class="td-week">
                                <div class="label">WEEK:</div>
                                <input class="input-week" type="number" placeholder="WEEK" oninput="changeWeek()">
                            </td>

                            <td class="td-no-booking">
                                <div class="label">NO BOOKING:</div>
                                <input class="input-no-booking" placeholder="NO BOOKING" type="number">
                            </td>

                            <td class="td-estimated-loading-date" style="display: none;">
                                <div class="label">ESTIMATED LOADING DATE:</div>
                                <input class="input-estimated-loading-date" placeholder="ESTIMATED LOADING DATE" type="text">
                            </td>

                            <td class="td-request-loading">
                                <div class="label">REQUEST LOADING:</div>
                                <input onmouseenter="addDateTime(this)" class="input-request-loading datetime" placeholder="REQUEST LOADING" type="text">
                            </td>
                        <tr>
                            <td class="td-container-number">
                                <div class="label">CONTAINER NUMBER:</div>
                                <input class="input-container-number" placeholder="CONTAINER NUMBER" type="text">
                            </td>  

                            <td class="td-seal-number">
                                <div class="label">SEAL NUMBER:</div>
                                <input class="input-seal-number" placeholder="SEAL NUMBER" type="text">
                            </td>

                            <td class="td-dc">
                                <div class="label">DC:</div>
                                <input class="input-dc" placeholder="DC" type="text">
                            </td> 

                            <td class="td-carrier">
                                <div class="label">CARRIER:</div>
                                <input class="input-carrier" placeholder="CARRIER" type="text" oninput="copyDataAllowBooking(this)" onchange="copyDataAllowBooking(this)">
                                <div class="dropdown">
                                    <button onclick="myFunction('table-update-dropdown-1')" class="dropbtn" id="dropbtn-1">Dropdown</button>
                                    <div id="table-update-dropdown-1" class="dropdown-content select-carrier">
                                      <input class="input-search-droplist" type="text" placeholder="Search.." id="table-update-input-search-dropdown-1" onkeyup="filterFunction('table-update-input-search-dropdown-1', 'table-update-dropdown-1')">
                                      
                                    </div>
                                </div>
                            </td> 
                        </tr>

                        <tr>
                            <td class="td-loading-location">
                                <div class="label">LOADING LOCATION:</div>
                                <input class="input-loading-location" placeholder=" LOADING LOCATION" type="text">
                                <select class="select-loading-location"></select>
                            </td>    

                            <td class="td-loading-date">
                                <div class="label">LOADING DATE:</div>
                                <input class="input-loading-date datetime" onmouseenter="addDateTime(this)" placeholder="LOADING DATE" type="text">
                            </td>
                            
                            <td class="td-ship-date">
                                <div class="label">SHIP DATE:</div>
                                <input class="input-ship-date datetime" onmouseenter="addDateTime(this)" placeholder="SHIP DATE" type="text">
                            </td>   

                            <td class="td-cdf-date">
                                <div class="label">CDF DATE:</div>
                                <input class="input-cdf-date datetime" onmouseenter="addDateTime(this)" placeholder="CDF DATE" type="text">
                            </td>
                        </tr>

                        <tr>
                            <td class="td-booking-number">
                                <div class="label">BOOKING NUMBER:</div>
                                <input value="" class="input-booking-number" placeholder="BOOKING NUMBER" type="text" oninput="autoFillAllowBook(this, 'table-update')">
                            </td>

                            <td class="td-cut-off-loading-date">
                                <div class="label">CUT OFF LOADING DATE:</div>
                                <input class="input-cut-off-loading-date datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CUT OFF LOADING DATE" type="text">
                            </td>

                            <td class="td-cy-cut-off">
                                <div class="label">CY CUT OFF:</div>
                                <input class="input-cy-cut-off datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CY CUT OFF" type="text">
                            </td>

                            <td class="td-ammentdent-bill-cut-off">
                                <div class="label">AMMENTDENT BILL CUT OFF:</div>
                                <input class="input-ammentdent-bill-cut-off datetime" onchange="copyDataAllowBooking(this)" onmouseenter="addDateTime(this)" placeholder="AMMENTDENT BILL CUT OFF" type="text">
                            </td>
                        </tr>
                            <td class="td-etd">
                                <div class="label">ETD:</div>
                                <input class="input-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="ETD" type="text">
                            </td>

                            <td class="td-new-etd">
                                <div class="label">NEW ETD:</div>
                                <input class="input-new-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="NEW ETD" type="text">
                            </td>

                            <td class="td-service">
                                <div class="label">SERVICE:</div>
                                <input class="input-service" placeholder="SERVICE" oninput="copyDataAllowBooking(this)" type="text">
                            </td>

                            <td class="td-eta">
                                <div class="label">ETA:</div>
                                <input class="input-eta" placeholder="ETA" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" type="text">
                            </td> 
                        <tr>
                            <td class="td-vessel">
                                <div class="label">VESSEL:</div>
                                <input class="input-vessel" placeholder="VESSEL" oninput="copyDataAllowBooking(this)" type="text">
                            </td>

                            <td class="td-picked-date">
                                <div class="label">PICKED DATE:</div>
                                <input class="input-picked-date datetime" onmouseenter="addDateTime(this)" placeholder="PICKED DATE" type="text">
                            </td>

                            <td class="td-vendor">
                                <div class="label">VENDOR:</div>
                                <input class="input-vendor" placeholder="VENDOR" type="text">
                                <select class="select-vendor"></select>
                            </td>

                            <td class="td-ata-pb">
                                <div class="label">ATA PHU BAI:</div>
                                <input class="input-ata-pb datetime" onmouseenter="addDateTime(this)" placeholder="ATA PHU BAI" type="text">
                            </td>
                        </tr>
                        <tr>
                            <td class="td-unloading-location">
                                <div class="label">UNLOADING LOCATION:</div>
                                <input class="input-unloading-location" placeholder="UNLOADING LOCATION" type="text">
                            </td>

                            <td class="td-unloading-date">
                                <div class="label">UNLOADING DATE:</div>
                                <input class="input-unloading-date datetime" onmouseenter="addDateTime(this)" placeholder="UNLOADING DATE" type="text">
                            </td>

                            <td class="td-export-saving-truck-date">
                                <div class="label">EXPORT SAVING TRUCK DATE:</div>
                                <input class="input-export-saving-truck-date" placeholder="EXPORT SAVING TRUCK DATE" type="text">
                            </td>
                            
                            <td class="td-reason-export-saving-truck">
                                <div class="label">REASON EXPORT SAVING TRUCK:</div>
                                <textarea class="input-reason-export-saving-truck" placeholder="REASON EXPORT SAVING TRUCK">

                                </textarea>
                            </td>
                        </tr>
                        <tr>
                            <td class="td-picked-at-port">
                                <div class="label">PICKED AT PORT:</div>
                                <input class="input-picked-at-port"/>
                                <select class="select-picked-at-port"></select>
                            </td>

                            <td class="td-dropping-at-port">
                                <div class="label">DROPPING AT PORT:</div>
                                <input class="input-dropping-at-port" placeholder="DROPPING AT PORT" type="text">
                                <select class="select-dropping-at-port"></select>
                            </td>

                            <td class="td-dropping-date">
                                <div class="label">DROPPING DATE:</div>
                                <input class="input-dropping-date datetime" onmouseenter="addDateTime(this)" placeholder="DROPPING DATE" type="text">
                            </td>

                            <td class="td-category-cont">
                                <div class="label">CONT TYPE</div>
                                <input class="input-category-cont" type="text" placeholder="CONT TYPE" oninput="copyDataAllowBooking(this)">
                            </td>
                        </tr>
                        <tr>
                            <td class="td-pre-booking-number">
                                <div class="label">PRE BOOKING NUMBER:</div>
                                <input class="input-pre-booking-number" placeholder="PRE BOOKING NUMBER" type="text" oninput="copyDataAllowBooking(this)">
                            </td>

                            <td class="td-note">
                                <div class="label">NOTE:</div>
                                <textarea class="input-note" placeholder="NOTE" type="text"></textarea>
                            </td>

                            <td class="td-color">
                                <div class="label">COLOR:</div>
                                <input style="width: 100%;" class="input-color" placeholder="NOTE" type="color"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="updateData()">Save changes</button>
            </div>
          </div>
        </div>
    </div>

    <button style="display: none;" data-toggle="modal" data-target="#updateRow" id="updateTrigger"></button>

    <script src="../../script/utils.js"></script>
    <!-- tinh chinh lai css -->
    <script>
        function cssOptimaize(){
            //tinh chinh lai textarea
            $("#table-info textarea").css("height","27px")
            //tinh chinh thead
            $("#table-info #thead-dc").css("min-width","3em");
            $("#table-info #thead-carrier").css("min-width", "7em");
            $("#table-info #thead-carrier").css("min-width", "7em");
            $("#table-info #thead-loading-location").css("min-width", "5em");
            //tinh chinh input
            $("#table-info .input-estimated-loading-date").css("width","3em");
            $("#table-info .input-dc").css("width","3em");
            $("#table-info button").css("width", "7em");
            $("#table-info .input-loading-location").css("width", "5em");
            $("#table-info .select-loading-location").css("width", "5em");
            $("#table-info .datetime").css("width", "10em");
        }
    </script>
    <!-- init data -->
    <script>
        function validateTime(time){
            if(!time) return true;
            if(time.match("^[0-9]*$")){
                return true
            }else{
                return false
            }
        }
        let url = new URLSearchParams(window.location.search);
        let year = url.get("year");
        let week = url.get("week");
        let arrSelectPickAtport = [];
        let arrSelectDroppingAtPort = [];
        let arrSelectLoadingLocation = [];
        let arrSelectVendor = [];
        let arrSelectCarrier = [];
        let regexTime = "^[0-9]*$";
        if(!validateTime(week) || !validateTime(year)){
            // window.location.href="/404";
        }
        let weekInput = $(".input-week");
        for(let i=0; i<weekInput.length; i++){
            $(weekInput[i]).val(+week+1);
        }
    </script>

    <script>
        function addDateTime(param){
            $(param).datetimepicker({format:'d/m/Y H:00:00'});
        }
        
        // them row moi
        function createRow(){
            let rank = $("#table-info tbody tr").length;
            let weekRoot = $($(".input-week")[0]).val();
            let tableCreate = "#table-create ";
            let nextRow =                
            `<tr id="tbody-${rank+1}" ondblclick="updateDataRow(this)">
                    <td class="td-check-box"><input class="input-checkbox" type="checkbox"></td>
                    
                    <td class="td-week">
                        <input style="width: 3em;" value="${weekRoot}" class="input-week" type="number" placeholder="WEEK" oninput="changeWeek()">
                        <div class="error-message error-input-week"></div>
                    </td>

                    <td class="td-stt" style="text-align:center">${rank+1}</td>

                    <td class="td-no-booking">
                        <input style="width: 5em;" value="${$(tableCreate+".td-no-booking "+"input").val()}" class="input-no-booking" placeholder="NO BOOKING" type="number" min=1>
                        <div class="error-message error-input-no-booking"></div>
                    </td>

                    <td class="td-estimated-loading-date">
                        <input value="${$(tableCreate+".td-estimated-loading-date "+"input").val()}" class="input-estimated-loading-date" placeholder="ESTIMATE LOADING DATE" type="text">
                        <div class="error-message error-input-estimated-loading-date"></div>
                    </td>

                   <td class="td-request-loading">
                        <input value="${$(tableCreate+".td-request-loading "+"input").val()}" class="input-request-loading" onmouseenter="addDateTime(this)" placeholder="ESTIMATE LOADING DATE" type="text" style="width:10em">
                        <div class="error-message error-input-request-loading"></div>
                    </td>

                    <td class="td-container-number">
                        <input value="${$(tableCreate+".td-container-number "+"input").val()}" class="input-container-number" placeholder="CONTAINER NUMBER" type="text">
                        <div class="error-message error-input-container-number"></div>
                    </td>

                    <td class="td-seal-number">
                        <input value="${$(tableCreate+".td-seal-number "+"input").val()}" class="input-seal-number" placeholder="SEAL NUMBER" type="text">
                        <div class="error-message error-input-seal-number datetime"></div>
                    </td>

                    <td class="td-dc">
                        <input value="${$(tableCreate+".td-dc "+"input").val()}"" class="input-dc" placeholder="DC" type="text">
                        <div class="error-message error-input-dc"></div>
                    </td>

                    <td class="td-carrier">
                        <input value="${$(tableCreate+".td-carrier "+"input").val()}" class="input-carrier" placeholder="CARRIER" type="text" oninput="copyDataAllowBooking(this)">
                        <div class="dropdown">
                            <button onclick="myFunction('dropdown-${rank+1}')" class="dropbtn" id="dropbtn-${rank+1}">
                                ${$(tableCreate+".td-carrier "+"input").val()}
                            </button>
                            <div id="dropdown-${rank+1}" class="dropdown-content select-carrier">
                                <input class="input-search-droplist" type="text" placeholder="Search.." id="input-search-dropdown-${rank+1}" onkeyup="filterFunction('input-search-dropdown-${rank+1}', 'dropdown-${rank+1}')">
                                <a onclick="selectData(this)"></a>
                                ${arrSelectCarrier.map(result=>`<a onclick="selectData(this)">${result}</a>`).join("")}
                            </div>
                        </div>
                        <div class="error-message error-input-booking-number"></div>
                    </td>

                    <td class="td-loading-location">
                        <input value="${$(tableCreate+".td-loading-location "+"input").val()}" class="input-loading-location" placeholder="LOCATION" type="text">
                        <select class="select-loading-location" style="width:5em">
                            <option value=' '></option>
                            ${arrSelectLoadingLocation.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-loading-location "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-loading-location"></div>
                    </td>

                    <td class="td-loading-date">
                        <input value="${$(tableCreate+".td-loading-date "+"input").val()}" class="input-loading-date datetime" onmouseenter="addDateTime(this)" placeholder="LOADING DATE" type="text">
                        <div class="error-message error-input-loading-date"></div>
                    </td>

                    <td class="td-ship-date">
                        <input value="${$(tableCreate+".td-ship-date "+"input").val()}" class="input-ship-date datetime" onmouseenter="addDateTime(this)" placeholder="SHIP DATE" type="text">
                        <div class="error-message error-input-ship-date"></div>
                    </td>

                    <td class="td-cdf-date">
                        <input value="${$(tableCreate+".td-cdf-date "+"input").val()}" class="input-cdf-date datetime" onmouseenter="addDateTime(this)" placeholder="CDF DATE" type="text">
                        <div class="error-message error-input-cdf-date datetime"></div>
                    </td>

                    <td class="td-booking-number">
                        <input value="${$(tableCreate+".td-booking-number "+"input").val()}" class="input-booking-number" placeholder="BOOKING NUMBER" type="text" oninput="autoFillAllowBook(this, 'table-info')">
                        <div class="error-message error-input-booking-number"></div>
                    </td>

                    <td class="td-cut-off-loading-date">
                        <input value="${$(tableCreate+".td-cut-off-loading-date "+"input").val()}" class="input-cut-off-loading-date datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CUT OFF LOADING DATE" type="text">
                        <div class="error-message error-input-cut-off-loading-date"></div>
                    </td>

                    <td class="td-cy-cut-off">
                        <input value="${$(tableCreate+".td-cy-cut-off "+"input").val()}" class="input-cy-cut-off datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CY CUT OFF" type="text">
                        <div class="error-message error-input-cy-cut-off"></div>
                    </td>

                    <td class="td-ammentdent-bill-cut-off">
                        <input value="${$(tableCreate+".td-ammentdent-bill-cut-off "+"input").val()}" class="input-ammentdent-bill-cut-off datetime" oninput="copyDataAllowBooking(this)" placeholder="AMMENT BILL CUT OFF" type="text">
                        <div class="error-message error-input-ammentdent-bill-cut-off"></div>
                    </td>

                    <td class="td-etd">
                        <input value="${$(tableCreate+".td-etd "+"input").val()}" class="input-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="ETD" type="text">
                        <div class="error-message error-input-etd datetime"></div>
                    </td>

                    <td class="td-new-etd">
                        <input value="${$(tableCreate+".td-new-etd "+"input").val()}" class="input-new-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="NEW ETD" type="text">
                        <div class="error-message error-input-new-etd datetime"></div>
                    </td>

                    <td class="td-service">
                        <input value="${$(tableCreate+".td-service "+"input").val()}" class="input-service" placeholder="SERVICE" oninput="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-service datetime"></div>
                    </td>

                    <td class="td-eta">
                        <input value="${$(tableCreate+".td-eta "+"input").val()}" class="input-eta" placeholder="ETA" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-eta datetime"></div>
                    </td>

                    <td class="td-vessel">
                        <input value="${$(tableCreate+".td-vessel "+"input").val()}" class="input-vessel" placeholder="VESSEL" oninput="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-vessel datetime"></div>
                    </td>
                    
                    <td class="td-picked-date">
                        <input value="${$(tableCreate+".td-picked-date "+"input").val()}" class="input-picked-date datetime" onmouseenter="addDateTime(this)" placeholder="PICKED DATE" type="text">
                        <div class="error-message error-input-picked-date datetime"></div>
                    </td>

                    <td class="td-vendor">
                        <input value="${$(tableCreate+".td-vendor "+"input").val()}" class="input-vendor" placeholder="VENDOR" type="text">
                        <select class="select-vendor">
                            <option value=' '></option>
                            ${arrSelectVendor.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-vendor "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-vendor datetime"></div>
                    </td>

                    <td class="td-ata-pb">
                        <input value="${$(tableCreate+".td-ata-pb "+"input").val()}" class="input-ata-pb datetime" onmouseenter="addDateTime(this)" placeholder="ATA PHU BAI" type="text">
                        <div class="error-message error-input-ata-pb datetime"></div>
                    </td>

                    <td class="td-unloading-location">
                        <input value="${$(tableCreate+".td-unloading-location "+"input").val()}" class="input-unloading-location" placeholder="UNLOADING LOCATION" type="text">
                        <div class="error-message error-input-unloading-location datetime"></div>
                    </td>

                    <td class="td-unloading-date">
                        <input value="${$(tableCreate+".td-unloading-date "+"input").val()}" class="input-unloading-date datetime" onmouseenter="addDateTime(this)" placeholder="UNLOADING DATE" type="text">
                        <div class="error-message error-input-unloading-date datetime"></div>
                    </td>

                    <td class="td-export-saving-truck-date">
                        <input value="${$(tableCreate+".td-export-saving-truck-date "+"input").val()}" class="input-export-saving-truck-date" placeholder="EXPORT SAVING TRUCK DATE" type="text">
                        <div class="error-message error-input-export-saving-truck-date datetime"></div>
                    </td>

                    <td class="td-reason-export-saving-truck">
                        <textarea class="input-reason-export-saving-truck" placeholder="REASON EXPORT SAVING TRUCK">${$(tableCreate+".td-reason-export-saving-truck "+"textarea").val()}</textarea>
                        <div class="error-message error-input-reason-export-saving-truck datetime"></div>
                    </td>

                    <td class="td-picked-at-port">
                        <input style="width:10em" value="${$(tableCreate+".td-picked-at-port "+"input").val()}" class="input-picked-at-port" />
                        <select class="select-picked-at-port" style="width:10em">
                            <option value=' '></option>
                            ${arrSelectPickAtport.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-picked-at-port "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-picked-at-port datetime"></div>
                    </td>

                    <td class="td-dropping-at-port">
                        <input style="display:none" value="${$(tableCreate+".td-dropping-at-port "+"input").val()}" class="input-dropping-at-port" placeholder="DROPPING AT PORT" type="text">
                        <select class="select-dropping-at-port">
                            <option value=' '></option>
                            ${arrSelectDroppingAtPort.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-dropping-at-port "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-dropping-at-port datetime"></div>
                    </td>

                    <td class="td-dropping-date">
                        <input value="${$(tableCreate+".td-dropping-date "+"input").val()}" class="input-dropping-date datetime" onmouseenter="addDateTime(this)" placeholder="DROPPING DATE" type="text">
                        <div class="error-message error-input-dropping-date datetime"></div>
                    </td>

                    <td class="td-category-cont">
                        <input style="width:3em" value="40" class="input-category-cont" type="text" placeholder="CONT CATEGORY" oninput="copyDataAllowBooking(this)">
                        <div class="error-message error-input-category-cont"></div>
                    </td>

                    <td class="td-pre-booking-number">
                        <input value="${$(tableCreate+".td-pre-booking-number "+"input").val()}" class="input-pre-booking-number" placeholder="PRE BOOKING NUMBER" type="text">
                        <div class="error-message error-input-pre-booking-number datetime"></div>
                    </td>

                    <td class="td-note">
                        <textarea class="input-note" placeholder="NOTE">${$(tableCreate+".td-note "+"textarea").val()}</textarea>
                        <div class="error-message error-input-note datetime"></div>
                    </td>
                </tr>`;
            $("#table-info tbody").append(nextRow);
            initSelect();
            cssOptimaize();
            $("#createRow .close").click();
            
        }
        
        //fill update row duoc chon
        function updateDataRow(row){
            let listChidren = $(row).children();
            let arrInput = [];
            let tableUpdate = $("#table-update tbody td");
            for(let i=0; i<tableUpdate.length; i++){
                
                let updateInput = $($(tableUpdate[i]).children()[1]);
                let rowTable = $($(listChidren[i+2]).children()[0]);
                let dropdown = $($(listChidren[i+2]).children()[1]);
                let selectOptionUpdate = $($(tableUpdate[i]).children()[2]);

                arrInput.push($(rowTable).attr("class")?.split(" ")[0]);
                if($(rowTable).attr("class")===$(updateInput).attr("class")){
                    $(updateInput).val($(rowTable).val());

                    if($(dropdown).hasClass("dropdown")){
                        let chidrenDropdown = $(dropdown).children();
                        for(let i=0; i<chidrenDropdown.length; i++){
                            if($(chidrenDropdown[i]).hasClass("dropbtn")){
                                let value = $(chidrenDropdown[i]).text();
                                importData(value)
                            }
                        }
                    }else{
                        $(selectOptionUpdate).val($(rowTable).val());
                        $(selectOptionUpdate).select2();
                    }
                }
                function importData(data){
                    for(let i=0; i<selectOptionUpdate.length; i++){
                        if($(selectOptionUpdate[i]).hasClass("dropdown")){
                            let select = $(selectOptionUpdate[i]).children();
                            for(let j=0; j<select.length; j++){
                                if($(select[i]).hasClass("dropbtn")){
                                    $(select[i]).text(data);
                                }
                                break;
                            }
                            break;
                        }
                    }
                }
            }
            // let selectList = $(".select-carrier");
            // for(let i=0; i<selectList.length; i++){
            //     $(selectList[i]).select2();
            // }
            $("#updateRow .modal-title").text(`UPDATE ROW ${$(row).attr("id").split("-")[1]}`)
            $("#updateTrigger").click();
        }
        
        // update row duoc chon
        function updateData(){
            let stt = $("#updateRow .modal-title").text().split(" ")[2];
            let listChidren = $(`#table-info tbody #tbody-${stt}`).children();
            let listInputBooking = $("#table-info .input-booking-number");
            let inputBookingVal = $("#table-update .input-booking-number").val();
            let arrInput = [];
            let tableUpdate = $("#table-update tbody td");
            let allows = [
                "input-category-cont",
                "input-new-etd", 
                "input-carrier",
                "input-cut-off-loading-date",
                "input-cy-cut-off", 
                "input-ammentdent-bill-cut-off",
                "input-etd",
                "input-service",
                "input-eta",
                "input-new-eta",
                "input-vessel",
                "input-pre-booking-number"
            ];
            // thay doi color
            let color = $($("#table-update .input-color")).val();
            for(let i=0; i<listInputBooking.length; i++){
                if(inputBookingVal==$(listInputBooking[i]).val() && inputBookingVal){
                    let row = $(listInputBooking[i]).parent().parent();
                    let idRow = $(listInputBooking[i]).parent().parent().attr("id");
                    $(row).css("background-color",color);
                    let inputInRow = $(`#${idRow} input`);
                    let buttonInRow = $(`#${idRow} button`);
                    let textareaInRow = $(`#${idRow} textarea`);
                    let selectInRow = $(`#${idRow} span`);
                    for(let j=0; j<inputInRow.length; j++){
                        $(inputInRow[j]).css("background-color",color);
                    }
                    for(let j=0; j<buttonInRow.length; j++){
                        $(buttonInRow[j]).css("background-color",color);
                    }
                    for(let j=0; j<textareaInRow.length; j++){
                        $(textareaInRow[j]).css("background-color",color);
                    }
                    // for(let j=0; j<selectInRow.length+1; j++){
                    //     if($(selectInRow[j]).attr("aria-labelledby")?.split("-").length > 0){
                    //         console.log(`#${idRow}`,selectInRow[j])
                    //         $(selectInRow[j]).css("background-color",color);
                    //     }
                    // }
                }
            }

            for(let i=0; i<tableUpdate.length; i++){
                
                let updateInput = $($(tableUpdate[i]).children()[1]);
                let rowTable = $($(listChidren[i+2]).children()[0]);

                let dropdown = $($(listChidren[i+2]).children()[1]);
                let selectOptionUpdate = $($(tableUpdate[i]).children()[2]);
                
                arrInput.push($(rowTable)?.attr("class")?.split(" ")[0]);
                if($(rowTable).attr("class")===$(updateInput).attr("class")){
                    $(rowTable).val($(updateInput).val());

                    for(let j=0; j<allows.length; j++){
                        if($(rowTable).hasClass(allows[j])){
                            copyDataAllowBooking($(rowTable))
                        }
                    }

                    if($(selectOptionUpdate).hasClass("dropdown")){
                        let chidrenDropdown = $(selectOptionUpdate).children();
                        for(let i=0; i<chidrenDropdown.length; i++){
                            if($(chidrenDropdown[i]).hasClass("dropbtn")){
                                let value = $(chidrenDropdown[i]).text();
                                importData(value)
                            }
                        }
                    }else{
                        if($(dropdown).val()){
                            $(dropdown).val($(selectOptionUpdate).val());
                            $(dropdown).select2();
                        }
                    }
                }
                function importData(data){
                    for(let i=0; i<dropdown.length; i++){
                        if($(dropdown[i]).hasClass("dropdown")){
                            let select = $(dropdown[i]).children();
                            for(let j=0; j<select.length; j++){
                                if($(select[i]).hasClass("dropbtn")){
                                    $(select[i]).text(data);
                                }
                                break;
                            }
                            break;
                        }
                    }
                }
            }
            
            $("#updateRow .close").click();
        }
        
        //auto fill allow booking 
        function autoFillAllowBook(booking, table){
            let allows = [
                "input-category-cont",
                "input-new-etd", 
                "input-carrier",
                "input-cut-off-loading-date",
                "input-cy-cut-off", 
                "input-ammentdent-bill-cut-off",
                "input-etd",
                "input-service",
                "input-eta",
                "input-new-eta",
                "input-vessel",
                "input-pre-booking-number"
            ];
            let select = [
                "select-category-cont",
                "select-new-etd", 
                "select-carrier",
                "select-cut-off-loading-date",
                "select-cy-cut-off", 
                "select-ammentdent-bill-cut-off",
                "select-etd",
                "select-service",
                "select-eta",
                "select-new-eta",
                "select-vessel",
                "select-pre-booking-number"
            ];
            let idRow = $(booking).parent().parent().attr("id");
            let rowsOfTable = $("#table-info tbody tr");
            let valueBookUpdate = $(booking).val().trim();
            let listInputBooking = $("#table-info .input-booking-number");
            
            for(let i=0; i<listInputBooking.length; i++){
                let valueCompare = $(listInputBooking[i]).val();
                if(valueCompare===valueBookUpdate && valueCompare!='' && valueBookUpdate!=''){
                    let j=0;
                    for(let allow of allows){
                        let targetCopy = $(`#table-info .${allow}`)[i];
                        let valueCopy = $(targetCopy).val();
                        $($(`#${table} #${idRow} .${allow}`)).val(valueCopy);

                        let valueSelect = $(`#${table} ${table=='table-info'?"#"+idRow:"tbody"} .${select[j]}`).val();

                        if(valueSelect){
                            $(`#${table} ${table=='table-info'?"#"+idRow:"tbody"} .${select[j]}`).val(valueCopy);
                            // $(`#${table} tbody .${select[j]}`).select2();
                        }else{
                            let listParent = $(`#${table} ${table=='table-info'?"#"+idRow:"tbody"} .${select[j]}`).parent();
                            for(let a=0; a<listParent.length; a++){
                                if($(listParent[a]).hasClass("dropdown")){
                                    let chidren = $(listParent[a]).children();
                                    $(chidren[0]).text(valueCopy);
                                }
                            }
                        }
                        j++;
                    }
                    break;
                }else{
                    // for(let allow of allows){
                    //     let targetCopy = $(`#table-info .${allow}`)[i]
                    //     let valueCopy = $(targetCopy).val();
                    //     $(`#${table} tbody .${allow}`).val("")
                    // }
                }
            }
            let countBookingNumber = 0;
            if(table!=='table-info'){
                countBookingNumber=1;
            }
            for(let i=0; i<listInputBooking.length; i++){
                let valueCompare = $(listInputBooking[i]).val();
                if(valueCompare===valueBookUpdate && valueCompare!='' && valueBookUpdate!=''){
                    countBookingNumber++;
                }
            }
            if(table=='table-info'){
                let idSelected = $(booking).parent().parent().attr("id");
                $(`#${idSelected} .input-no-booking`).val(countBookingNumber)
            }else{
                let nameRowUpdate;
                if(table=='table-update'){
                    $(`#table-update .input-no-booking`).val(countBookingNumber);
                    nameRowUpdate = $("#updateRow .modal-title").text();
                }else{
                    $(`#table-create .input-no-booking`).val(countBookingNumber);
                    nameRowUpdate = $("#createRow .modal-title").text();
                }
                let stt = nameRowUpdate.split(" ")[2];
                
                $(`#table-info #tbody-${stt} .input-no-booking`).val(countBookingNumber);
            }
            
            // let selectList = $(".select-carrier");
            // for(let i=0; i<selectList.length; i++){
            //     $(selectList[i]).select2();
            // }
            
        }
        
        // xoa row da duoc checkbox
        function deleteRow() {
            let listCheckBox = $(".input-checkbox");
            for(let i=0; i<listCheckBox.length; i++){
                if($(listCheckBox[i]).is(":checked") && i!=0){
                    // console.log($(`#tbody-${i+1}`))
                    $(`#tbody-${i+1}`).remove();
                }
            }
            let listStt = $(".td-stt");
            let listRow = $("#table-info tbody tr");
            for(let i=0; i<listStt.length; i++){
                $(listStt[i]).text(i+1);
            }
            for(let i=0; i<listRow.length; i++){
                $(listRow[i]).attr("id", `tbody-${i+1}`)
            }
        }
        
        //thay doi hang loat week
        function changeWeek() { 
            let listRow = $(".input-week");
            let weekRoot = $(listRow[0]).val();
            for(let i=1; i<listRow.length; i++){
                $(listRow[i]).val(weekRoot);
            }
         }
        
         //copy data theo booking
        function copyDataAllowBooking(row) {  
            let rowClass = $(row).attr("class").split(" ")[0];
            let rowIncludeData = $(row).parent().parent();
            let rankOfRow = +$(rowIncludeData).attr("id").split("-")[1];
            let rowsOfTable = $("#table-info tbody tr");
            let bookingNumberRoot = $($(".input-booking-number")[rankOfRow-1]).val();
            let inputRoot = $($(`.${rowClass}`)[rankOfRow-1]).val();
            for(let i=0; i<rowsOfTable.length; i++){
                let bookingNumberTaget = $($(".input-booking-number")[i]).val();

                if(bookingNumberRoot!==""&& bookingNumberTaget===bookingNumberRoot && i!==rankOfRow-1){
                    $($(`.${rowClass}`)[i]).val(inputRoot);
                    let arrSelect = rowClass.split("-");
                    arrSelect[0] = "select";
                    let selectClass = arrSelect.join("-");
                    
                    let listDroplist = $($(`.${selectClass}`)[i]);
                    
                    for(let j=0; j<listDroplist.length; j++){
                        if($(listDroplist[j]).parent().hasClass("dropdown")){
                            $($(listDroplist[j]).parent().children()[0]).text(inputRoot)
                        }
                    }
                    // if($(`.${selectClass}`).val()){
                    //     $(`.${selectClass}`).val(inputRoot);
                    //     // $(`.${selectClass}`).select2();
                    // }
                }
            }
        }
        
        //auto fill by select
        function autoFillBySelect(row){
            // let className= $(row).attr("class");
            // let classRowTableInfo = $($(row).parent().parent()).attr("id");
            // let inputBooking = $(`#${classRowTableInfo} .input-booking-number`).val();
            // let carrier = $(`#${classRowTableInfo} .input-carrier`).val();
            // let listBookingNumberTableInfo = $("#table-info .input-booking-number");
            // for(let i=0; i<listBookingNumberTableInfo.length; i++){
            //     let valueBooking = $(listBookingNumberTableInfo[i]).val();
            //     if(valueBooking===inputBooking){
            //         let idRowTarget = $(listBookingNumberTableInfo[i]).parent().parent().attr("id");
            //         $(`#${idRowTarget} .select-carrier`).val(carrier);
            //         $(`#${idRowTarget} .input-carrier`).val(carrier);
            //         $(`#${idRowTarget} .select-carrier`).select2();
            //     }
            // }
        }
        //post du lieu len database
        function postData(){
            let listRow = $("#table-info tbody tr");
            let datas = [];

            let week = $(".input-week");
            let contCategory = $(".input-category-cont");
            let noBooking = $(".input-no-booking");
            let bookingNumber = $(".input-booking-number");
            let carrier = $(".input-carrier");
            let dc = $(".input-dc");
            let containerNumber = $(".input-container-number");
            let estimateLoadingDate = $(".input-estimated-loading-date");
            let requestLoading = $(".input-request-loading");
            let loadingLocation = $(".input-loading-location");
            let loadingDate = $(".input-loading-date");
            let shipDate = $(".input-ship-date");
            let cutOffLoadingDate = $(".input-cut-off-loading-date");
            let cyCutOff = $(".input-cy-cut-off");
            let ammentdentBillCutOff = $(".input-ammentdent-bill-cut-off");
            let etd = $(".input-etd");
            let newEtd = $(".input-new-etd");
            let service = $(".input-service");
            let eta = $(".input-eta");
            let vessel = $(".input-vessel");
            let pickedDate = $(".input-picked-date");
            let vendor = $(".input-vendor");
            let ataPb = $(".input-ata-pb");
            let unloadingLocation = $(".input-unloading-location");
            let unloadingDate = $(".input-unloading-date");
            let cdfDate = $(".input-cdf-date");
            let exportSavingTruckDate = $(".input-export-saving-truck-date");
            let reasonExportSavingTruck = $(".input-reason-export-saving-truck");
            let pickedAtPort = $(".input-picked-at-port");
            let droppingAtPort = $(".input-dropping-at-port");
            let droppingDate = $(".input-dropping-date");
            let preBookingNumber = $(".input-pre-booking-number");
            let seal = $(".input-seal-number");
            let note = $(".input-note");

            let arrError = {};
            for(let i=0; i<listRow.length; i++){
                let data = {};
                let errArr = [];
                
                data.color = convertNull($(listRow[i]).css("background-color")==="rgba(0, 0, 0, 0)"?"rgba(255, 255, 255)":$(listRow[i]).css("background-color"));

                data.newEta = null

                data.week = convertNull($(week[i]).val().trim());

                data.contCategory = convertNull($(contCategory[i]).val().trim());
                
                data.noBooking = convertNull($(noBooking[i]).val().trim());
                
                data.bookingNumber = convertNull($(bookingNumber[i]).val().trim());
                
                data.carrier = convertNull($(carrier[i]).val().trim());
                
                data.dc = convertNull($(dc[i]).val().trim());
                
                data.containerNumber = convertNull($(containerNumber[i]).val().trim());
                
                data.idSystem = convertNull(`${$(containerNumber[i]).val().trim()}-${Math.random().toFixed(8).split(".")[1]}`);
                
                data.idCurrent = 
                convertNull($(bookingNumber[i]).val().trim())?
                `${$(bookingNumber[i]).val().replace(/\s+/g,"")}-${Math.random().toFixed(10).split(".")[1]}`:
                Math.random().toFixed(10).split(".")[1];

                data.estimateLoadingDate = convertNull($(estimateLoadingDate[i]).val().trim());

                data.requestLoading = convertNull(formatDate($(requestLoading[i]).val()));
                
                data.loadingLocation = convertNull($(loadingLocation[i]).val().trim());
                
                data.loadingDate = convertNull(formatDate($(loadingDate[i]).val()));
                
                data.shipDate = convertNull(formatDate($(shipDate[i]).val()));
                
                data.cutOffLoadingDate = convertNull(formatDate($(cutOffLoadingDate[i]).val()));
                
                data.cyCutOff = convertNull(formatDate($(cyCutOff[i]).val()));
                
                data.ammentdentBillCutOff = convertNull(formatDate($(ammentdentBillCutOff[i]).val()));
                
                data.etd = convertNull(formatDate($(etd[i]).val()));
                
                data.newEtd = convertNull(formatDate($(newEtd[i]).val()));
                
                data.service = convertNull($(service[i]).val().trim());
                
                data.eta = convertNull(formatDate($(eta[i]).val().trim()));
                
                data.vessel = convertNull($(vessel[i]).val().trim())
                
                data.pickedDate = convertNull(formatDate($(pickedDate[i]).val()));
                
                data.vendor = convertNull($(vendor[i]).val().trim());
                
                data.ataPb = convertNull(formatDate($(ataPb[i]).val()))
                
                data.unloadingLocation = convertNull($(unloadingLocation[i]).val().trim())
                
                data.unloadingDate = convertNull(formatDate($(unloadingDate[i]).val()));
                
                data.cdfDate = convertNull(formatDate($(cdfDate[i]).val()));
                
                data.exportSavingTruckDate = convertNull($(exportSavingTruckDate[i]).val().trim());
                
                data.reasonExportSavingTruck = convertNull($(reasonExportSavingTruck[i]).val().trim());
                
                data.picAtPort = convertNull($(pickedAtPort[i]).val().trim());
                
                data.droppingAtPort = convertNull($(droppingAtPort[i]).val().trim());
                
                data.droppingDate = convertNull(formatDate($(droppingDate[i]).val()));
                
                data.preBookingNumber = convertNull($(preBookingNumber[i]).val().trim());
                
                data.seal = convertNull($(seal[i]).val().trim());
                
                data.note = convertNull($(note[i]).val().trim());

                let listInput = $($(listRow[i]).children())
                
                for(let j=0; j<listInput.length; j++){
                    let input = $($(listInput[j]).children()[0])
                    if(!$(listInput[j]).hasClass("td-checkbox") && !$(listInput[j]).hasClass("td-stt")){
                        errArr.push($(input).attr("class").split(" ")[0])
                    }
                }

                let error = validate(errArr, `#table-info tbody #tbody-${i+1}`)
                
                if(error.length > 0){
                    arrError[i+1] = error;
                }
                
                datas.push(data);
            }
            // console.log(arrError);
            let resultData = [];
            for(let i=0; i<datas.length; i++){
                if(datas[i]["carrier"] && datas[i]["bookingNumber"] && datas[i]["noBooking"]){
                    resultData.push(datas[i])
                }
            }
            //hien thi thong bao loi
            // for(let key of Object.keys(arrError)){
            //     for(let j=0; j < arrError[key].length; j++){
            //         let clasKey = Object.keys(arrError[key][j])[0];
            //         let errMessage = Object.values(arrError[key][j])[0];
            //         $(`#table-info tbody #tbody-${key} .error-${clasKey}`).text(errMessage)
            //     }
            // }
            console.log(resultData)
            if(resultData.length > 0){
                
                $.ajax({
                    url: host + `/api/checkExistWeek?week=${$($(".input-week")[0]).val()}`,
                    dataType: "JSON"
                })
                .done(result=>{
                    if(result.length==0){
                        $("#loading-post-data").css("display","block");
                        $("#create-post-data").css("display","none");
                        $("#upload-btn").attr("disabled",true);
                        $.ajax({
                            headers: {
                                'Content-Type':'application/json'
                            },
                            url: host+"/api/create-plan-loading",
                            type: "POST",
                            data:JSON.stringify(resultData),
                            })
                        .done((result)=>{
                            for(let i=0; i<$("input").length; i++){
                                $($("input")[i]).val("");
                            }
                            window.location.href = "/"
                        })
                        .fail((e)=>{
                            $("#loading-post-data").css("display","none");
                            $("#create-post-data").css("display","block");
                            $("#upload-btn").attr("disabled",false);
                            console.log(e);
                        })
                    }else{
                        alert(`WEEK ${$($(".input-week")[0]).val()} have been existed in ${new Date().getFullYear()}`)
                    }
                })
            }else{
                alert("Không có dữ liệu nào được tải")
            }
        }
        
        // validate du lieu dau vao
        function validate(listInput, selectorInput){
            let arrValidate = [];
            let validate = {
                "input-category-cont":{
                    required: "This input is required"
                },
                // "input-no-booking":{
                //     required: "This input is required"
                // }, 
                "input-booking-number":{
                    required: "This input is required"
                }, 
                "input-carrier":{
                    required: "This input is required"
                },
                // "input-cut-off-loading-date":{
                //     required: "This input is required"
                // },
                // "input-cy-cut-off":{
                //     required: "This input is required"
                // },
                // "input-ammentdent-bill-cut-off":{
                //     required: "This input is required"
                // },
                // "input-etd":{
                //     required: "This input is required"
                // },
                // "input-service":{
                //     required: "This input is required",
                // },
                // "input-eta":{
                //     required: "This input is required",
                // },
                // "input-vessel":{
                //     required: "This input is required",
                // },
                // "input-ata-pb":{
                //     required: "This input is required",
                // }
            };
            for(let i=0; i<listInput.length; i++){
                for(let key of Object.keys(validate)){
                    if(listInput[i]===key){
                        // console.log(key)
                        if($(selectorInput +" ."+key).val().trim()=='' && validate[key]["required"]){
                            arrValidate.push({[key]:validate[key]["required"]});
                        }
                    }
                }
            }
            let errorMessage = $(".error-message");
            for(let i=0; i<errorMessage.length; i++){
                $(errorMessage[i]).text("");
            }
            return arrValidate;
        }
    </script>
    
    <!-- danh cho nhung select -->
    <script>
        let pickedAtPorts = $(".select-picked-at-port");
        let inputPicked = $(".input-picked-at-port");

        let droppedAtPorts = $(".select-dropping-at-port");
        let inputDroppedAtPort = $(".input-dropping-at-port");

        let loadingLocations = $(".select-loading-location");
        let inputLoadingLocation = $(".input-loading-location");

        let vendor = $(".select-vendor");
        let inputVendor = $(".input-vendor");

        let carirer = $(".select-carrier");
        let inputCarrier = $(".input-carrier");

        //khoi tao gia tri cua select vao input
        function initSelect(){

            //picked at port
            let pickedAtPorts = $(".select-picked-at-port");
            let inputPicked = $(".input-picked-at-port");
            for(let i=0; i<pickedAtPorts.length; i++){
                $(inputPicked[i]).css("display","none")
                $(pickedAtPorts[i]).on("change", ()=>{
                    let valueSelect = $(pickedAtPorts[i]).find(":selected").val();
                    $(inputPicked[i]).val(valueSelect);
                })
            }
            // dropping at port
            let droppedAtPorts = $(".select-dropping-at-port");
            let inputDroppedAtPort = $(".input-dropping-at-port");
            for(let i=0; i<droppedAtPorts.length; i++){
                $(inputDroppedAtPort[i]).css("display","none")
                $(droppedAtPorts[i]).on("change", ()=>{
                    let valueSelect = $(droppedAtPorts[i]).find(":selected").val();
                    $(inputDroppedAtPort[i]).val(valueSelect);
                })
            }
            // loading location
            let loadingLocations = $(".select-loading-location");
            let inputLoadingLocation = $(".input-loading-location");
            for(let i=0; i<loadingLocations.length; i++){
                $(inputLoadingLocation[i]).css("display","none")
                $(loadingLocations[i]).on("change", ()=>{
                    let valueSelect = $(loadingLocations[i]).find(":selected").val();
                    $(inputLoadingLocation[i]).val(valueSelect);
                })
            }
            // vendor
            let vendor = $(".select-vendor");
            let inputVendor = $(".input-vendor");
            for(let i=0; i<vendor.length; i++){
                $(inputVendor[i]).css("display","none")
                $(vendor[i]).on("change", ()=>{
                    let valueSelect = $(vendor[i]).find(":selected").val();
                    $(inputVendor[i]).val(valueSelect);
                })
            }
            // carrier
            let carrier = $(".select-carrier");
            let inputCarrier = $(".input-carrier");
            for(let i=0; i<carrier.length; i++){
                $(inputCarrier[i]).css("display","none")
                $(carrier[i]).on("change", ()=>{
                    let valueSelect = $(carrier[i]).find(":selected").val();
                    $(inputCarrier[i]).val(valueSelect);
                })
            }
            let selectList = $("select");
            for(let i=0; i<selectList.length; i++){
                $(selectList[i]).select2();
            }
        }
        initSelect();

        //init data vao select option
        function initPickedAtPort(){
            $.ajax({
                url: host + "/api/picked-at-port",
                type: "GET",
                dataType: "JSON"
            })
            .done((result)=>{
                for(let i=0; i<result.length; i++){
                    arrSelectPickAtport.push(result[i]["port"])
                }
                for(let i=0; i<pickedAtPorts.length; i++){
                    $(pickedAtPorts[i]).append("<option value=' '></option>")
                    $(inputPicked[i]).val("")
                    for(let j=0; j<result.length; j++){
                        $(pickedAtPorts[i]).append(`<option value="${result[j]["port"]}">${result[j]["port"]}</option>`);
                    }
                }
            })
            .fail((err)=>{
                console.log(err);
            })
        }
        function initDroppedAtPort(){
            $.ajax({
                url: host + "/api/dropped-at-port",
                type: "GET",
                dataType: "JSON"
            })
            .done((result)=>{
                for(let i=0; i<result.length; i++){
                    arrSelectDroppingAtPort.push(result[i]["port"])
                }
                for(let i=0; i<droppedAtPorts.length; i++){
                    $(droppedAtPorts[i]).append(`<option value=' '></option>`)
                    $(inputDroppedAtPort[i]).val("")
                    for(let j=0; j<result.length; j++){
                        $(droppedAtPorts[i]).append(`<option value="${result[j]["port"]}">${result[j]["port"]}</option>`);
                    }
                }
            })
            .fail((err)=>{
                console.log(err);
            })
        }
        function initLoadingLocation(){
            $.ajax({
                url: host + "/api/loading-location",
                type: "GET",
                dataType: "JSON"
            })
            .done((result)=>{
                for(let i=0; i<result.length; i++){
                    arrSelectLoadingLocation.push(result[i]["port"])
                }
                for(let i=0; i<loadingLocations.length; i++){
                    $(loadingLocations[i]).append("<option value=' '></option>")
                    $(inputLoadingLocation[i]).val("")
                    for(let j=0; j<result.length; j++){
                        $(loadingLocations[i]).append(`<option value="${result[j]["port"]}">${result[j]["port"]}</option>`);
                    }
                }
            })
            .fail((err)=>{
                console.log(err);
            })
        }
        function initVendor(){
            $.ajax({
                url: host + "/api/vendor",
                type: "GET",
                dataType: "JSON"
            })
            .done((result)=>{
                for(let i=0; i<result.length; i++){
                    arrSelectVendor.push(result[i]["port"])
                }
                for(let i=0; i<vendor.length; i++){
                    $(vendor[i]).append("<option value='MT'></option>")
                    $(inputVendor[i]).val("")
                    for(let j=0; j<result.length; j++){
                        $(vendor[i]).append(`<option value="${result[j]["port"]}">${result[j]["port"]}</option>`);
                    }
                }
            })
            .fail((err)=>{
                console.log(err);
            })
        }
        function initCarrier(){
            $.ajax({
                url: host + "/api/carrier",
                type: "GET",
                dataType: "JSON"
            })
            .done((result)=>{
                for(let i=0; i<result.length; i++){
                    arrSelectCarrier.push(result[i]["port"])
                }
                for(let i=0; i<carirer.length; i++){
                    $(carirer[i]).append("<option value=' '></option>")
                    $(inputCarrier[i]).val("")
                    $($(".td-carrier .dropbtn")[i]).text("")
                    for(let j=0; j<result.length; j++){
                        $(carirer[i]).append(`<a onclick="selectData(this)">${result[j]["port"]}</a>`);
                    }
                }
                initRawRow();
                initSelect();
                cssOptimaize();
            })
            .fail((err)=>{
                console.log(err);
            })
        }
        initPickedAtPort();
        initDroppedAtPort();
        initLoadingLocation();
        initVendor();
        initCarrier();

        let selectList = $("select");
        for(let i=0; i<selectList.length; i++){
            $(selectList[i]).select2();
        }
    </script>

    <script>
        let idSelected;
        function myFunction(id) {
            document.getElementById(id).classList.toggle("show");
            idSelected = id;
        }

        function filterFunction(idInput, idDropdown) {
            var input, filter, ul, li, a, i;
            input = document.getElementById(idInput);
            filter = input.value.toUpperCase();
            div = document.getElementById(idDropdown);
            a = div.getElementsByTagName("a");
            for (i = 0; i < a.length; i++) {
                txtValue = a[i].textContent || a[i].innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                a[i].style.display = "";
                } else {
                a[i].style.display = "none";
                }
            }
        }
        function selectData(rowSelected){
            let table = $(rowSelected).parent().parent().parent().parent().parent().parent().attr("id");
            
            let rowType = $(rowSelected).parent().parent().parent().attr("class");

            let listChidrenRowType = $(rowSelected).parent().parent().parent().children();

            let rowTarget = $(rowSelected).parent().parent().parent();

            let listChildrenTd = $(rowSelected).parent().parent().parent().parent().children().children();

            let valueBookingRoot;

            for(let i=0; i<listChildrenTd.length; i++){
                if($(listChildrenTd[i]).hasClass("input-booking-number")){
                    valueBookingRoot = $(listChildrenTd[i]).val();
                    break;
                }
            }
            let indexBtn = +`${table=="table-infor"?1:2}`;
            
            let btnSelect = $($(listChidrenRowType)[indexBtn]).children();

            let idBtn = $($(btnSelect)[0]).attr("id");

            let valueTarget = $(rowSelected).text();

            // console.log($(`#${table} .${rowType} #${idBtn}`))

            $(`#${table} .${rowType} #${idBtn}`).text(valueTarget);


            let listBooking = $(`#${table} .input-booking-number`);

            let listCarrier = $(`#${table} .input-carrier`);

            let listButtonSelect = $(`#${table} .td-carrier button`);

            
            for(let i=0; i<listBooking.length; i++){
                let valueBookingCompare = $(listBooking[i]).val();
                if(valueBookingRoot===valueBookingCompare && valueBookingRoot && valueBookingCompare){
                    $(listCarrier[i]).val(valueTarget);
                    $(listButtonSelect[i]).text(valueTarget);
                }
            }

            // $(`#${table} .${rowType} input`).val(valueTarget)

            let indexInput = +`${table=="table-infor"?0:1}`;

            $(listChidrenRowType[indexInput]).val(valueTarget)

            $(`#${idSelected}`).removeClass("show")
        }
    </script>
    <!-- init 50 row -->
    <script>
        function initRawRow(){
            for(let i=1; i<40; i++){
            let rank = $("#table-info tbody tr").length;
            let weekRoot = $($(".input-week")[0]).val();
            let tableCreate = "#table-create ";
            let nextRow =                
            `<tr id="tbody-${rank+1}" ondblclick="updateDataRow(this)">
                    <td class="td-check-box"><input class="input-checkbox" type="checkbox"></td>
                    
                    <td class="td-week">
                        <input style="width: 3em;" value="${$(tableCreate+".td-week "+"input").val()}" class="input-week" type="number" placeholder="WEEK" oninput="changeWeek()">
                        <div class="error-message error-input-week"></div>
                    </td>

                    <td class="td-stt" style="text-align:center">${rank+1}</td>

                    <td class="td-no-booking">
                        <input style="width: 5em;" value="${$(tableCreate+".td-no-booking "+"input").val()}" class="input-no-booking" placeholder="NO BOOKING" type="number" min=1>
                        <div class="error-message error-input-no-booking"></div>
                    </td>

                    <td class="td-estimated-loading-date" style="display: none;">
                        <input value="${$(tableCreate+".td-estimated-loading-date "+"input").val()}" class="input-estimated-loading-date" placeholder="ESTIMATE LOADING DATE" type="text">
                        <div class="error-message error-input-estimated-loading-date"></div>
                    </td>

                    <td class="td-request-loading">
                        <input value="${$(tableCreate+".td-request-loading "+"input").val()}" class="input-request-loading datetime" placeholder="REQUEST LOADING" onmouseenter="addDateTime(this)" type="text">
                        <div class="error-message error-input-estimated-loading-date"></div>
                    </td>

                    <td class="td-container-number">
                        <input value="${$(tableCreate+".td-container-number "+"input").val()}" class="input-container-number" placeholder="CONTAINER NUMBER" type="text">
                        <div class="error-message error-input-container-number"></div>
                    </td>

                    <td class="td-seal-number">
                        <input value="${$(tableCreate+".td-seal-number "+"input").val()}" class="input-seal-number" placeholder="SEAL NUMBER" type="text">
                        <div class="error-message error-input-seal-number datetime"></div>
                    </td>

                    <td class="td-dc">
                        <input value="${$(tableCreate+".td-dc "+"input").val()}"" class="input-dc" placeholder="DC" type="text">
                        <div class="error-message error-input-dc"></div>
                    </td>

                    <td class="td-carrier">
                        <input value="${$(tableCreate+".td-carrier "+"input").val()}" class="input-carrier" placeholder="CARRIER" type="text" oninput="copyDataAllowBooking(this)">
                        <div class="dropdown">
                            <button onclick="myFunction('dropdown-${rank+1}')" class="dropbtn" id="dropbtn-${rank+1}">
                                ${$(tableCreate+".td-carrier "+"input").val()}
                            </button>
                            <div id="dropdown-${rank+1}" class="dropdown-content select-carrier">
                                <input class="input-search-droplist" type="text" placeholder="Search.." id="input-search-dropdown-${rank+1}" onkeyup="filterFunction('input-search-dropdown-${rank+1}', 'dropdown-${rank+1}')">
                                <a onclick="selectData(this)"></a>
                                ${arrSelectCarrier.map(result=>`<a onclick="selectData(this)">${result}</a>`).join("")}
                            </div>
                        </div>
                        <div class="error-message error-input-booking-number"></div>
                    </td>

                    <td class="td-loading-location">
                        <input value="${$(tableCreate+".td-loading-location "+"input").val()}" class="input-loading-location" placeholder="LOCATION" type="text">
                        <select class="select-loading-location" style="width:5em">
                            <option value=' '></option>
                            ${arrSelectLoadingLocation.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-loading-location "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-loading-location"></div>
                    </td>

                    <td class="td-loading-date">
                        <input value="${$(tableCreate+".td-loading-date "+"input").val()}" class="input-loading-date datetime" onmouseenter="addDateTime(this)" placeholder="LOADING DATE" type="text">
                        <div class="error-message error-input-loading-date"></div>
                    </td>

                    <td class="td-ship-date">
                        <input value="${$(tableCreate+".td-ship-date "+"input").val()}" class="input-ship-date datetime" onmouseenter="addDateTime(this)" placeholder="SHIP DATE" type="text">
                        <div class="error-message error-input-ship-date"></div>
                    </td>

                    <td class="td-cdf-date">
                        <input value="${$(tableCreate+".td-cdf-date "+"input").val()}" class="input-cdf-date datetime" onmouseenter="addDateTime(this)" placeholder="CDF DATE" type="text">
                        <div class="error-message error-input-cdf-date datetime"></div>
                    </td>

                    <td class="td-booking-number">
                        <input value="${$(tableCreate+".td-booking-number "+"input").val()}" class="input-booking-number" placeholder="BOOKING NUMBER" type="text" oninput="autoFillAllowBook(this, 'table-info')">
                        <div class="error-message error-input-booking-number"></div>
                    </td>

                    <td class="td-cut-off-loading-date">
                        <input value="${$(tableCreate+".td-cut-off-loading-date "+"input").val()}" class="input-cut-off-loading-date datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CUT OFF LOADING DATE" type="text">
                        <div class="error-message error-input-cut-off-loading-date"></div>
                    </td>

                    <td class="td-cy-cut-off">
                        <input value="${$(tableCreate+".td-cy-cut-off "+"input").val()}" class="input-cy-cut-off datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="CY CUT OFF" type="text">
                        <div class="error-message error-input-cy-cut-off"></div>
                    </td>

                    <td class="td-ammentdent-bill-cut-off">
                        <input value="${$(tableCreate+".td-ammentdent-bill-cut-off "+"input").val()}" class="input-ammentdent-bill-cut-off datetime" oninput="copyDataAllowBooking(this)" placeholder="AMMENT BILL CUT OFF" type="text">
                        <div class="error-message error-input-ammentdent-bill-cut-off"></div>
                    </td>

                    <td class="td-etd">
                        <input value="${$(tableCreate+".td-etd "+"input").val()}" class="input-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="ETD" type="text">
                        <div class="error-message error-input-etd datetime"></div>
                    </td>

                    <td class="td-new-etd">
                        <input value="${$(tableCreate+".td-new-etd "+"input").val()}" class="input-new-etd datetime" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" placeholder="NEW ETD" type="text">
                        <div class="error-message error-input-new-etd datetime"></div>
                    </td>

                    <td class="td-service">
                        <input value="${$(tableCreate+".td-service "+"input").val()}" class="input-service" placeholder="SERVICE" oninput="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-service datetime"></div>
                    </td>

                    <td class="td-eta">
                        <input value="${$(tableCreate+".td-eta "+"input").val()}" class="input-eta" placeholder="ETA" onmouseenter="addDateTime(this)" onchange="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-eta datetime"></div>
                    </td>

                    <td class="td-vessel">
                        <input value="${$(tableCreate+".td-vessel "+"input").val()}" class="input-vessel" placeholder="VESSEL" oninput="copyDataAllowBooking(this)" type="text">
                        <div class="error-message error-input-vessel datetime"></div>
                    </td>
                    
                    <td class="td-picked-date">
                        <input value="${$(tableCreate+".td-picked-date "+"input").val()}" class="input-picked-date datetime" onmouseenter="addDateTime(this)" placeholder="PICKED DATE" type="text">
                        <div class="error-message error-input-picked-date datetime"></div>
                    </td>

                    <td class="td-vendor">
                        <input value="${$(tableCreate+".td-vendor "+"input").val()}" class="input-vendor" placeholder="VENDOR" type="text">
                        <select class="select-vendor">
                            <option value=' '></option>
                            ${arrSelectVendor.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-vendor "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-vendor datetime"></div>
                    </td>

                    <td class="td-ata-pb">
                        <input value="${$(tableCreate+".td-ata-pb "+"input").val()}" class="input-ata-pb datetime" onmouseenter="addDateTime(this)" placeholder="ATA PHU BAI" type="text">
                        <div class="error-message error-input-ata-pb datetime"></div>
                    </td>

                    <td class="td-unloading-location">
                        <input value="${$(tableCreate+".td-unloading-location "+"input").val()}" class="input-unloading-location" placeholder="UNLOADING LOCATION" type="text">
                        <div class="error-message error-input-unloading-location datetime"></div>
                    </td>

                    <td class="td-unloading-date">
                        <input value="${$(tableCreate+".td-unloading-date "+"input").val()}" class="input-unloading-date datetime" onmouseenter="addDateTime(this)" placeholder="UNLOADING DATE" type="text">
                        <div class="error-message error-input-unloading-date datetime"></div>
                    </td>

                    <td class="td-export-saving-truck-date">
                        <input value="${$(tableCreate+".td-export-saving-truck-date "+"input").val()}" class="input-export-saving-truck-date" placeholder="EXPORT SAVING TRUCK DATE" type="text">
                        <div class="error-message error-input-export-saving-truck-date datetime"></div>
                    </td>

                    <td class="td-reason-export-saving-truck">
                        <textarea class="input-reason-export-saving-truck" placeholder="REASON EXPORT SAVING TRUCK">${$(tableCreate+".td-reason-export-saving-truck "+"textarea").val()}</textarea>
                        <div class="error-message error-input-reason-export-saving-truck datetime"></div>
                    </td>

                    <td class="td-picked-at-port">
                        <input style="width:10em" value="${$(tableCreate+".td-picked-at-port "+"input").val()}" class="input-picked-at-port" />
                        <select class="select-picked-at-port" style="width:10em">
                            <option value=' '></option>
                            ${arrSelectPickAtport.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-picked-at-port "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-picked-at-port datetime"></div>
                    </td>

                    <td class="td-dropping-at-port">
                        <input style="display:none" value="${$(tableCreate+".td-dropping-at-port "+"input").val()}" class="input-dropping-at-port" placeholder="DROPPING AT PORT" type="text">
                        <select class="select-dropping-at-port">
                            <option value=' '></option>
                            ${arrSelectDroppingAtPort.map(result=>{
                                return `<option value="${result}"
                                ${$(tableCreate+".td-dropping-at-port "+"input").val()===result?"selected":""}
                                >
                                    ${result}
                                </option>`
                            })}
                        </select>
                        <div class="error-message error-input-dropping-at-port datetime"></div>
                    </td>

                    <td class="td-dropping-date">
                        <input value="${$(tableCreate+".td-dropping-date "+"input").val()}" class="input-dropping-date datetime" onmouseenter="addDateTime(this)" placeholder="DROPPING DATE" type="text">
                        <div class="error-message error-input-dropping-date datetime"></div>
                    </td>

                    <td class="td-category-cont">
                        <input style="width:3em" value="40" class="input-category-cont" type="text" placeholder="CONT CATEGORY" oninput="copyDataAllowBooking(this)">
                        <div class="error-message error-input-category-cont"></div>
                    </td>

                    <td class="td-pre-booking-number">
                        <input value="${$(tableCreate+".td-pre-booking-number "+"input").val()}" class="input-pre-booking-number" placeholder="PRE BOOKING NUMBER" type="text" oninput="copyDataAllowBooking(this)">
                        <div class="error-message error-input-pre-booking-number datetime"></div>
                    </td>

                    <td class="td-note">
                        <textarea class="input-note" placeholder="NOTE">${$(tableCreate+".td-note "+"textarea").val()}</textarea>
                        <div class="error-message error-input-note datetime"></div>
                    </td>
                </tr>`;
            $("#table-info tbody").append(nextRow);
        }
        } 
    </script>
</body>
</html>